var studyArea = ee.FeatureCollection('ft:1EECa2nG9DeaDCG28qSwofkxrpsjYnTFlxFdNJiov', 'geometry');
var yearSpan = 1
var sum = ee.Reducer.sum();
var mean = ee.Reducer.mean();
// var band_names = ['prcp'];
var years = ee.List.sequence(1985,2015);
print(years)
var daymet = ee.ImageCollection("NASA/ORNL/DAYMET_V3");
var zone = 11;//Specify UTM zone
var resolution = 30;//Specify spatial resolutio in meters
var resampleMethod = 'bilinear';//Specify resampling method (bicubic generally works well for terrain data)

//function to get daily reducer for the data - for a single year
function getDailyReducer(year, yearStart, yearEnd,reducer,band_name){
  var startYear = ee.Date.fromYMD(year,1,1);
  var endYear = ee.Date.fromYMD(year,1,1).advance(yearSpan,'year').advance(-1,'day');
  var band = daymet.filterDate(startYear,endYear).select(band_name);
  band = band.reduce(reducer);
  band = band.set('system:time_start', startYear.millis());
  return band;
}

//function to get annual reducer - for all years
function getAnnualAverage(years, yearSpan, reducer, band_name){
  var stack = years.map(function(yr){
      var startYear = yr; var endYear = ee.Number(yr).add(yearSpan).subtract(1);
      return getDailyReducer(yr, startYear, endYear, reducer,band_name);
      });
  stack = ee.ImageCollection(ee.List(stack).flatten()).sort('system:time_start');
  return stack.mean();
}

var precipMeanStack = getAnnualAverage(years, yearSpan, sum,'prcp')
var tminMeanStack = getAnnualAverage(years, yearSpan, mean,'tmin')

print('Projection, crs, and crs_transform:', precipMeanStack.projection());
print('Scale in meters:', precipMeanStack.projection().nominalScale());

Map.addLayer(precipMeanStack.clip(studyArea), {min: 100, max: 1230}, 'Annual Average Precip');
Map.addLayer(tminMeanStack.clip(studyArea), {min: -7, max: 14}, 'Annual Average Min Temp');

Export.image.toDrive({image: precipMeanStack.clip(studyArea).resample(resampleMethod), description: 'DAYMET_Annual_Average_precip',maxPixels: 2e9, region: studyArea, crs: 'EPSG:26911',scale: resolution});
Export.image.toDrive({image: tminMeanStack.clip(studyArea).resample(resampleMethod), description: 'DAYMET_Annual_Average_tmin',maxPixels: 2e9, region: studyArea, crs: 'EPSG:26911',scale: resolution});